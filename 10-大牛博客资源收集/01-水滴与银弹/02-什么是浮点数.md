在计算机中，针对高精度的小数，我们一般使用【浮点数】来表示小数

##### 什么是浮点数？

回想定点数的定义，定点指的是小数点位置不变。

那回到浮点数，就是指小数点位置可以是漂浮不定。

怎么理解呢？

浮点数采用科学计数法的方式来表示。

##### 科学计数法

8.345 = 8.345 * 10^0

8.345 = 83.45 *10^-1

8.345= 834.5 * 10^-2

……

通过科学计数法，小数点就变得漂浮不定

##### 浮点数如何表示数字

V =(-1)^S * M*R^E

变量含义如下：

S : 符号位，取值0或者1，决定一个数字的符号，0表示正，1表示负

M：尾数，8.345就是尾数

R：基数，表示进制数，10进制或者2进制

E：指数,整数表示，例如上面的10^-1,-1就是指数

在计算机中，想用浮点数来表示一个数字，按照公式确定几个变量即可。

假设用32bit表示一个浮点数，

| 符号S | 指数E | 尾数M |
| ----- | ----- | ----- |
| 31    | 30~21 | 20~0  |

符号位占1bit

指数E占10bit

尾数M占21bit

按照这个规则，将十进制25.125转换为浮点数（D为十进制，B为2进制）

1. 整数：25(D) =11001(B)

2. 小数部分：0.125(D)=0.001(B)

3. 用二进制科学技术表示：25.125(D) =11001.001(B)=1.1001001*2^4(B)

   所以符号位S=0,尾数M=1.001001(B),E=4(D)=100(B)

   填充到32bit上，就是这样：

   【0】【10 0000 0000】【1001 0010 0000 0000 0000 】

   浮点数虽然出来了，但是有一个问题

   符号位和指数位占用的空间，是我们随便定义的。

   你说，S占1bit,E占5bit，尾数占25bit行不行呢？

   当然也可以。

   【0】【1 0000】【1001 0010 0000 0000 0000 0000 0】

   但我们能发现，指数位越多，尾数位就会越少，表示的范围就越大，精度也会越差。反之，范围变小，精度变高

   早期的时候，不同的计算机厂商都会有自己的浮点数规则，造成了同一个程序在不同厂商的计算机中做浮点运算，竟然还得先转换成别的厂商的浮点数才行。

   这里彰显的秦始皇的伟大，书同文才是王道，程序员也迫切需要一个统一的浮点数标准

   ##### 浮点数标准

   1985年，IEEE组织退出了浮点数标准，有两种格式

   1.  单精度浮点数float：共32位，S占1bit，E占8bit，M占23bit
   2. 双精度浮点数double：共64位，S占1bit，E占11bit，M占52bit

为了让范围，数字最大化，还有一些特别的规定

1. M的第一位总是1，所以它可以省略不写，因此就23位就可以表示24位有效数字
2. E是个无符号整数，float中占8位，取值范围0~255，但因为指数可以为负，规定在存入E时在它原本的额值加上一个中间数127，取值范围为-127~128，表示double，占11位，中间数为1023，取值范围为-1023~1024

除了尾数和指数为，还有以下补充

1. E非全0，且非全1
2. E全0，尾数非0，非规格化数，尾数隐藏位不再是1，而是0，这样可以表示0和很小的数
3. E全1，尾数全0：正无穷大/负无穷大，正负取决S位
4. E全1，尾数非0，NAN(not a number)

##### 标准浮点数的表示

知道了上面的标准，我们再重现转化25.125

25.125(D)=11001.001(B)=1.1001001*2^4(B)

S=0, M=1.001001=001001(去掉隐藏位)，E=4+124(中间数)=135(D)=1000 0111(B)

【0】【1000 0111】【0010 0100 0000 0000 0000 000】

这就是标准32位浮点数的结果

##### 浮点数精度损失

我们常听到用浮点数计算会用精度的损失

为什么呢？

其实很简单，现在我们先来表示一个数字0.2

0.2(D) =0.0011……(B)

十进制的0.2无法精确转换成二进制的小数，而计算机宽度有限，无限循环的小数只能被截断，必然导致小数精度发何时能损失

##### 浮点数的范围和精度有多大

最后我们来了解一下浮点数的范围和精度

以float为例：

最大：+1.111……1*2^127(小数点后23个)

1.11111……1约等于2，2^128=3.4*10^38

范围-3.4*10^38~~3.4 *10^38

float最小二进制数为0.000……1，小数点后22个0，一个1

可以知道，虽然浮点数范围精度有限，但大体可以满足我们需求了，所以一般情况下，我们用浮点数来存储小数点

